<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Random Team</title>
    <link rel="stylesheet" href="src/css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anuphan:wght@100..700&display=swap" rel="stylesheet">
    

</head>

<style>
    body {
        background-color: #24252b;
        color: white;
        font-family: 'Anuphan', sans-serif;
    }
</style>

<body>
    
<div class="container my-5">
    <h4>template section</h4>
    <div class="row g-5" id="character-row"></div>
</div>

<template id="character-template-random">
  <div class="character-block">
    <div class="character-block-img">
      <img class="img-fluid">
      <img class="elemental">
    </div>
    <div class="name text-truncate"></div>
  </div>
</template>


<div class="container my-5">
    <h4 class="fw-bold">Characters &nbsp;&nbsp;&nbsp;<span class="text-secondary h6">Showing 100 characters</span></h4>
    <hr>
    <div class="d-flex justify-content-between">
        <input type="checkbox" class="btn-check" id="all" checked autocomplete="off">
        <label class="btn btn-checkbox-icon text-light mr-1" for="all">&nbsp;All&nbsp;</label>

        <input type="checkbox" class="btn-check" id="4star" autocomplete="off">
        <label class="btn btn-checkbox-icon text-purple" for="4star">4★</label>
        <input type="checkbox" class="btn-check" id="5star" autocomplete="off">
        <label class="btn btn-checkbox-icon text-gold mr-1" for="5star">5★</label>


        <input type="checkbox" class="btn-check" id="pyro" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="pyro">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/pyro.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="hydro" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="hydro">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/hydro.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="dendro" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="dendro">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/dendro.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="electro" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="electro">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/electro.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="anemo" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="anemo">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/anemo.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="cryo" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="cryo">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/cryo.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="geo" autocomplete="off">
        <label class="btn btn-checkbox-icon mr-1" for="geo">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/geo.webp" class="img-element-icon">
        </label>


        <input type="checkbox" class="btn-check" id="sword" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="sword">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/weapons/sword.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="claymore" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="claymore">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/weapons/claymore.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="bow" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="bow">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/weapons/bow.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="catalyst" autocomplete="off">
        <label class="btn btn-checkbox-icon" for="catalyst">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/weapons/catalyst.webp" class="img-element-icon">
        </label>
        <input type="checkbox" class="btn-check" id="polearm" autocomplete="off">
        <label class="btn btn-checkbox-icon mr-1" for="polearm">
            <img src="https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/weapons/polearm.webp" class="img-element-icon">
        </label>


        <div class="dropdown w-100 mr-1" style="max-width: 300px;">
            <button id="dropdownRegion" class="btn btn-secondary dropdown-toggle w-100" type="button" data-bs-toggle="dropdown" data-bs-auto-close="outside" aria-expanded="false">
                Select Region
            </button>
            <ul class="dropdown-menu p-2 w-100">
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="mondstadt" value="Mondstadt">
                    <label class="form-check-label" for="mondstadt">Mondstadt</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="liyue" value="Liyue">
                    <label class="form-check-label" for="liyue">Liyue</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="inazuma" value="Inazuma">
                    <label class="form-check-label" for="inazuma">Inazuma</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="sumeru" value="Sumeru">
                    <label class="form-check-label" for="sumeru">Sumeru</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="fontaine" value="Fontaine">
                    <label class="form-check-label" for="fontaine">Fontaine</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="natlan" value="Natlan">
                    <label class="form-check-label" for="natlan">Natlan</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="nodkrai" value="Nod-Krai">
                    <label class="form-check-label" for="nodkrai">Nod-Krai</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="snezhnaya" value="Snezhnaya">
                    <label class="form-check-label" for="snezhnaya">Snezhnaya</label>
                </div>
                </li>
                <li>
                <div class="form-check">
                    <input class="form-check-input region-checkbox" type="checkbox" id="other" value="Other">
                    <label class="form-check-label" for="other">Other</label>
                </div>
                </li>
                <button class="btn btn-outline-primary w-100 mt-3" id="selectAllBtn">Select All</button>
            </ul>
        </div>

        <input type="checkbox" class="btn-check" id="female" autocomplete="off">
        <label class="btn btn-checkbox-icon text-purple" for="female">&nbsp;F&nbsp;</label>
        <input type="checkbox" class="btn-check" id="male" autocomplete="off">
        <label class="btn btn-checkbox-icon text-blue mr-1" for="male">&nbsp;M&nbsp;</label>
        
        
        <input type="checkbox" class="btn-check" id="sustain" autocomplete="off">
        <label class="btn btn-checkbox-icon text-light" for="sustain">
            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="briefcase-medical" class="svg-inline--fa fa-briefcase-medical " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="17"><path fill="currentColor" d="M464 96H384V48C384 21.5 362.5 0 336 0h-160C149.5 0 128 21.5 128 48V96H48C21.5 96 0 117.5 0 144v288C0 458.5 21.5 480 48 480h416c26.5 0 48-21.5 48-48v-288C512 117.5 490.5 96 464 96zM176 48h160V96h-160V48zM368 314c0 8.836-7.164 16-16 16h-54V384c0 8.836-7.164 16-15.1 16h-52c-8.835 0-16-7.164-16-16v-53.1H160c-8.836 0-16-7.164-16-16v-52c0-8.838 7.164-16 16-16h53.1V192c0-8.838 7.165-16 16-16h52c8.836 0 15.1 7.162 15.1 16v54H352c8.836 0 16 7.162 16 16V314z"></path></svg>
        </label>

        
    </div>

    

<div class="row row-cols-10 g-2 mt-3" id="character-filter">
<!-- JS จะใส่ col ที่นี่ -->
</div>


<template id="character-template-filter">
  <div class="col">
    <input type="checkbox" class="btn-check" autocomplete="off">
    <label class="character-selector">
      <div class="character-block-img">
        <img class="img-fluid" src="">
        <img class="elemental" src="">
      </div>
      <div class="name text-truncate"></div>
    </label>
  </div>
</template>
  

    
</div>


</body>
</html>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js" integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q" crossorigin="anonymous"></script>

<script>
fetch('src/characters.json')
  .then(res => res.json())
  .then(characters => {
    const row = document.getElementById('character-row');
    const filterContainer = document.getElementById('character-filter');
    const randomTemplate = document.getElementById('character-template-random');
    const filterTemplate = document.getElementById('character-template-filter');

    // 1) สุ่มตัวละคร 8 ตัว ใส่ character-row
    const shuffled = [...characters].sort(() => 0.5 - Math.random());
    const showCharacters = shuffled.slice(0, 8);

    for (let i = 0; i < showCharacters.length; i += 4) {
      const col = document.createElement('div');
      col.className = 'col-6';

      const flex = document.createElement('div');
      flex.className = 'd-flex gap-2';

      showCharacters.slice(i, i + 4).forEach(char => {
        const clone = randomTemplate.content.cloneNode(true);

        const imgWrapper = clone.querySelector('.character-block-img');
        const charImg = clone.querySelector('.img-fluid');
        const elemImg = clone.querySelector('.elemental');
        const name = clone.querySelector('.name');

        if (!imgWrapper || !charImg || !elemImg || !name) {
          console.error('Template missing elements');
          return;
        }

        charImg.src = char.Image;
        charImg.alt = char.Name;
        elemImg.src = `https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/${char.Elemental.toLowerCase()}.webp`;
        elemImg.loading = 'lazy';
        name.textContent = char.Name;

        imgWrapper.classList.add(`rarity-${char.Rarity}`);

        flex.appendChild(clone);
      });

      col.appendChild(flex);
      row.appendChild(col);
    }

    // 2) แสดงตัวละครทั้งหมด ใส่ character-filter
    characters.forEach(char => {
      const clone = filterTemplate.content.cloneNode(true);

      const checkbox = clone.querySelector('.btn-check');
      const label = clone.querySelector('.character-selector');
      const imgWrapper = clone.querySelector('.character-block-img');
      const charImg = clone.querySelector('.img-fluid');
      const elemImg = clone.querySelector('.elemental');
      const name = clone.querySelector('.name');

      if (!checkbox || !label || !imgWrapper || !charImg || !elemImg || !name) {
        console.error('Template missing elements');
        return;
      }

      // id/for สำหรับ checkbox (Traveler พิเศษ)
      let checkboxId = char.Name;
      if (char.Name.toLowerCase() === 'traveler') {
        checkboxId = `${char.Name}-${char.Elemental}`;
      }
      checkboxId = checkboxId.toLowerCase().replace(/\s+/g, '-');

      checkbox.id = checkboxId;
      label.setAttribute('for', checkbox.id);
      checkbox.checked = true;

      charImg.src = char.Image;
      charImg.alt = char.Name;
      elemImg.src = `https://raw.githubusercontent.com/kanjanaw/randomteam/main/src/images/icons/elements/${char.Elemental.toLowerCase()}.webp`;
      name.textContent = char.Name;

      imgWrapper.classList.add(`rarity-${char.Rarity}`);

      filterContainer.appendChild(clone);
    });
  })
  .catch(err => console.error('Error loading JSON:', err));




// function สำหรับ dropdown แสดง ... และจำนวน
const dropdownBtn = document.getElementById('dropdownRegion');
const checkboxes = document.querySelectorAll('.region-checkbox');
const selectAllBtn = document.getElementById('selectAllBtn');

function updateDropdownText() {
  const selected = Array.from(checkboxes).filter(c => c.checked).map(c => c.value);
  if (selected.length === 0) {
    dropdownBtn.textContent = 'Select Region';
  } else {
    let label = selected.join(', ');
    const count = ` (${selected.length})`;
    const maxLength = 25;
    if (label.length > maxLength) label = label.slice(0, maxLength - 3) + '...';
    dropdownBtn.textContent = label + count;
  }

  // ปรับปุ่ม Select All / Unselect All
  if (selected.length === checkboxes.length) {
    selectAllBtn.textContent = 'Unselect All';
  } else {
    selectAllBtn.textContent = 'Select All';
  }
}

checkboxes.forEach(cb => cb.addEventListener('change', updateDropdownText));

selectAllBtn.addEventListener('click', () => {
  const allSelected = Array.from(checkboxes).every(cb => cb.checked);
  checkboxes.forEach(cb => cb.checked = !allSelected);
  updateDropdownText();
});


</script>


